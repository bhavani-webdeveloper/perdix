    
    STEPS FOR DEPL
          Transfer file from UAT to Kinara-sit
                  ## sudo scp -P 25499 perdix-server-0.0.2-SNAPSHOT.war kinarauser@52.4.230.141:/home/kinarauser/perdix-server-0.0.2-SNAPSHOT-13092016.WAR

Transfer war from UAT to release folder
          
          sudo scp -P 25499 dev@52.206.175.145:/opt/data/applications/perdix8/releases/perdix-server-0.0.2-SNAPSHOT.war /opt/mount_point/application/releasesperdix-server-0.0.2-SNAPSHOT-22092016.war

          Stop tomcat
          cd /opt/mount_point/tomcat/bin/
          sudo ./shutdown.sh
          ps -ef | grep java
          sudo kill <1.8 java process number>

          Delete the existing .war and folder (perdix-server.war and peerdix-server)
          cd /opt/mount_point/tomcat/webapps/
          sudo rm perdix-server.war
          sudo rm -r perdix-server

          Move file to webapps folder for deployment
          sudo cp /opt/mount_point/application/release/perdix-server-0.0.2-SNAPSHOT-ddmmyyyy.war /opt/mount_point/tomcat/webapps/

          start tomcat
           cd /opt/mount_point/tomcat/bin/
          sudo ./startup.sh

          once deployed, change the encore pointing argument in perdix-server/WEB-INI/class/conf/application-dev.yml

          find encore argument and change as http://uatperdix.kgfs.co.in/encore to http://52.4.230.141/encore
          save and close

          Stop tomcat
          cd /opt/mount_point/tomcat/bin/
          sudo ./shutdown.sh
          ps -ef | grep java
          sudo kill <1.8 java process number>

          start tomcat
           cd /opt/mount_point/tomcat/bin/
          sudo ./startup.sh

************************************************************************************
**********************************************************************************************************************


PENDING in  UAT



Perdix Migration
ALTER TABLE `ach_registration` 
CHANGE COLUMN `name_of_the_destination_bank_with_branch` `name_of_the_destination_bank_with_branch` VARCHAR(500) NULL DEFAULT NULL ;

ALTER TABLE `pdc_summary` 
CHANGE COLUMN `bank_name` `bank_name` VARCHAR(150) NULL DEFAULT NULL ,
CHANGE COLUMN `branch_name` `branch_name` VARCHAR(150) NULL DEFAULT NULL ;


update loan_account_documents set forms_key ='vendor_declaration_loan' where document_code ='VENDORDECLARATION';

CREATE TABLE `ach_registration_snapshot` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `version` int(11) NOT NULL DEFAULT '0',
  `loan_account_number` varchar(45) NOT NULL,
  `mandate_id` int(11) NOT NULL,
  `mandate_date` date NOT NULL,
  `sponsor_bank_code` varchar(45) DEFAULT NULL,
  `utility_code` varchar(45) DEFAULT NULL,
  `name_of_utility_biller_bank_company` varchar(100) DEFAULT NULL,
  `account_type` varchar(45) DEFAULT NULL,
  `legal_account_number` varchar(45) DEFAULT NULL,
  `name_of_the_destination_bank_with_branch` varchar(500) DEFAULT NULL,
  `ifsc_code` varchar(45) DEFAULT NULL,
  `micr_code` varchar(45) DEFAULT NULL,
  `debit_amt_of` varchar(45) DEFAULT NULL,
  `upto_maximum_amt` decimal(10,2) DEFAULT '0.00',
  `amount` decimal(10,2) DEFAULT '0.00',
  `consumer_reference_number` varchar(45) DEFAULT NULL,
  `schem_plan_reference_no` varchar(45) DEFAULT NULL,
  `frequency` varchar(45) DEFAULT NULL,
  `start_date` date DEFAULT NULL,
  `end_date` date DEFAULT NULL,
  `account_holder_name` varchar(200) DEFAULT NULL,
  `customer_additional_information` varchar(200) DEFAULT NULL,
  `telephone_no` varchar(11) DEFAULT NULL,
  `mobil_number` varchar(11) DEFAULT NULL,
  `email_id` varchar(45) DEFAULT NULL,
  `umnr_no` varchar(45) DEFAULT NULL,
  `mandate_status` enum('PENDING','SUBMITTED','RE-SUBMITTED','REJECTED','ACCEPTED') DEFAULT NULL,
  `rejection_code` varchar(45) DEFAULT NULL,
  `rejection_reason` varchar(200) DEFAULT NULL,
  `initial_reject_reason` varchar(200) DEFAULT NULL,
  `processed_on_with_umrn` date DEFAULT NULL,
  `sponsor_account_code` VARCHAR(45) DEFAULT NULL,
  `created_by` VARCHAR(45) NOT NULL,
  `created_at` DATETIME NOT NULL,
  `last_edited_by` VARCHAR(45) NULL,
   `last_edited_at` DATETIME NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;

####################################################################################################


PENDING UAT DEV
  PERDIX MIGRATION --
  ALTER TABLE lms_product_master
  ADD COLUMN `sms_product_name` varchar(50) DEFAULT NULL AFTER `new_product`;

  ENCORE MIGRATION --

  ALTER TABLE `loan_od_products`
     ADD COLUMN `first_demand_interest_adjustment_allowed` INT NULL DEFAULT 0 AFTER `security_deposit_allowed`;

  ALTER TABLE `loan_od_demands`
     ADD COLUMN `interest_adjustment_magnitude` DECIMAL(14,2) NULL AFTER `demand_adjustment_currency`,
     ADD COLUMN `interest_adjustment_currency` VARCHAR(3) NULL AFTER `interest_adjustment_magnitude`;

  ALTER TABLE `loan_od_working_registers`
     ADD COLUMN `interest_adjustment_magnitude` DECIMAL(14,2) NULL AFTER `demand_adjustment_currency`,
     ADD COLUMN `interest_adjustment_currency` VARCHAR(3) NULL AFTER `interest_adjustment_magnitude`;
  
  update loan_od_products set first_demand_interest_adjustment_allowed = 1 where repayment_method = 1;
  update loan_od_products set demand_day = 0;

  update loan_od_working_registers set interest_adjustment_magnitude='0.00', interest_adjustment_currency='INR' where 
    interest_adjustment_magnitude is null;
  update loan_od_working_registers set total_fee_due_magnitude = 0 where total_fee_due_magnitude is null;
  update loan_od_demands set interest_adjustment_magnitude='0.00', interest_adjustment_currency='INR' where 
    interest_adjustment_magnitude is null;


--


****************************************************************************************************

ENCORE: maininterface-1.0.0.4-SNAPSHOT_02102016-1.war


COMPLETED MIGRAION in UAT and SIT

Encore Migration
ALTER TABLE `account_pdc` CHANGE COLUMN `bank_name` `bank_name` VARCHAR(150) NULL DEFAULT NULL  , CHANGE COLUMN `branch_name` `branch_name` VARCHAR(150) NULL DEFAULT NULL  ;

Perdix Migration
INSERT INTO `translations` (`id`, `label_code`, `category`, `sub_category`, `type`, `en`, `hi`, `ta`) VALUES
(NULL, 'BOOKING_DASHBOARD', 'LOANS', 'BOOKING', 'FIELD_LABEL', 'Booking DB', '', '');

INSERT INTO `translations` (`id`, `label_code`, `category`, `sub_category`, `type`, `en`, `hi`, `ta`) VALUES
(NULL, 'DISBURSEMENT_DASHBOARD', 'LOANS', 'DISBURSEMENT', 'FIELD_LABEL', 'Disbursement DB', '', '');

INSERT INTO `translations` (`id`, `label_code`, `category`, `sub_category`, `type`, `en`, `hi`, `ta`) VALUES
(NULL, 'ACHPDC_DASHBOARD', 'LOANS', 'ACHPDC', 'FIELD_LABEL', 'ACH / PDC DB', '', '');

INSERT INTO `translations` (`label_code`, `category`, `sub_category`, `type`, `en`, `hi`, `ta`) VALUES
('PDC_CHEQUE_LEAVES', '', 'PDC Cheque Leaves', 'FIELD_LABEL', 'PDC Cheque Leaves', '', ''),
('SECURITY_CHEQUE_DETAILS', '', 'Security Cheque Details', 'FIELD_LABEL', 'Security Cheque Details', '', '');

INSERT INTO `reference_code` (`version`, `classifier`, `name`, `code`, `parent_classifier`, `parent_reference_code`, `field1`, `field2`, `field3`, `field4`, `field5`, `created_by`, `created_at`, `last_edited_by`, `last_edited_at`) VALUES
(1, 'ach_mandate_status', 'ACCEPTED', '5', NULL, NULL, 'ACCEPTED', NULL, NULL, NULL, NULL, 'adminkinara', '2016-08-30 05:33:45', NULL, '2016-08-30 05:33:45'),
( 1, 'ach_mandate_status', 'REJECTED', '4', NULL, NULL, 'REJECTED', NULL, NULL, NULL, NULL, 'adminkinara', '2016-08-30 05:33:45', NULL, '2016-08-30 05:33:45'),
( 1, 'ach_mandate_status', 'RE-SUBMITTED', '3', NULL, NULL, 'RE-SUBMITTED', NULL, NULL, NULL, NULL, 'adminkinara', '2016-08-30 05:33:45', NULL, '2016-08-30 05:33:45'),
( 1, 'ach_mandate_status', 'SUBMITTED', '2', NULL, NULL, 'SUBMITTED', NULL, NULL, NULL, NULL, 'adminkinara', '2016-08-30 05:33:45', NULL, '2016-08-30 05:33:45'),
( 1, 'ach_mandate_status', 'PENDING', '1', NULL, NULL, 'PENDING', NULL, NULL, NULL, NULL, 'adminkinara', '2016-08-30 05:33:45', NULL, '2016-08-30 05:33:45');

INSERT INTO `reference_code` (`version`, `classifier`, `name`, `code`, `parent_classifier`, `parent_reference_code`, `field1`, `field2`, `field3`, `field4`, `field5`, `created_by`, `created_at`, `last_edited_by`, `last_edited_at`) VALUES
(1, 'p2p_customer_category', 'CHRONIC', '4', NULL, NULL, 'CHRONIC', '', NULL, NULL, NULL, 'adminkinara', '2016-08-20 05:18:53', NULL, '2016-08-20 05:18:53'),
(1, 'p2p_customer_category', 'PROBLEMATIC', '3', NULL, NULL, 'PROBLEMATIC', '', NULL, NULL, NULL, 'adminkinara', '2016-08-20 05:18:53', NULL, '2016-08-20 05:18:53'),
(1, 'p2p_customer_category', 'DIFFICULT', '2', NULL, NULL, 'DIFFICULT', '', NULL, NULL, NULL, 'adminkinara', '2016-08-20 05:18:53', NULL, '2016-08-20 05:18:53'),
(1, 'p2p_customer_category', 'EASY', '1', NULL, NULL, 'EASY', '', NULL, NULL, NULL, 'adminkinara', '2016-08-20 05:18:53', NULL, '2016-08-20 05:18:53');

INSERT INTO `reference_code` ( `version`, `classifier`, `name`, `code`, `parent_classifier`, `parent_reference_code`, `field1`, `field2`, `field3`, `field4`, `field5`, `created_by`, `created_at`, `last_edited_by`, `last_edited_at`) VALUES
(1, 'ach_account_type', 'CASH CREDIT', '13', NULL, NULL, 'CASH CREDIT', '', NULL, NULL, NULL, 'adminkinara', '2016-08-20 05:18:53', NULL, '2016-08-20 05:18:53');


INSERT INTO `translations` (`label_code`, `category`, `sub_category`, `type`, `en`, `hi`, `ta`) VALUES
('PDC_LOANS_SEARCH', '', 'PDC Loan Search', 'FIELD_LABEL', 'PDC Loan Search', '', ''),
('SEARCH_PDC_LOANS', '', 'Search PDC Loans', 'FIELD_LABEL', 'Search PDC Loans', '', '');




#######################################################################################################################

COMPLETED MIGRATION in UAT , SIT and DEV  (POST MIGRATION)


ALTER TABLE `portfolio_insurance_master` 
ADD COLUMN `insurance_type` ENUM('Individual', 'Group') NULL DEFAULT NULL AFTER `total_premium`;
 
ALTER TABLE `portfolio_insurance_master` 
ADD UNIQUE INDEX `age_gender_sum_tenure_insurancetype` (`age` ASC, `gender` ASC, `tenure_in_year` ASC, `sum_assured` ASC, `insurance_type` ASC);

--Run truncate table for portfolio insurance and populate fresh set of records

ALTER TABLE `bank_account_master` ADD `sponsor_bank_code` VARCHAR(50) NULL AFTER `generic_bank_account_flag`, ADD `utility_code` VARCHAR(50) NULL AFTER `sponsor_bank_code`, ADD `is_ach_account` BOOLEAN NULL AFTER `utility_code`;

INSERT INTO `pages` (`uri`, `title`, `short_title`, `icon_class`, `direct_access`, `offline`, `state`, `page_name`, `page_id`, `addl_params`) VALUES ('Page/Engine/loans.individual.achpdc.DemandDownloads', 'DEMAND_DOWNLOADS', '', 'fa fa-briefcase', '0', '0', 'Page.Engine', 'loans.individual.achpdc.DemandDownloads', '', '');

INSERT INTO `reference_code` (`version`, `classifier`, `name`, `code`, `parent_classifier`, `parent_reference_code`, `field1`, `field2`, `field3`, `field4`, `field5`, `created_by`, `created_at`, `last_edited_by`, `last_edited_at`) VALUES
(1, 'ach_account_type', 'SAVINGS', '10', NULL, NULL, 'SAVINGS', NULL, NULL, NULL, NULL, 'adminkinara', '2016-08-30 05:33:45', NULL, '2016-08-30 05:33:45'),
(1, 'ach_account_type', 'CURRENT', '11', NULL, NULL, 'CURRENT', NULL, NULL, NULL, NULL, 'adminkinara', '2016-08-30 05:33:45', NULL, '2016-08-30 05:33:45');


###################################################################################

COMPLATED UAT (POST MIGRATION)


INSERT INTO `pages` (`id`, `uri`, `title`, `short_title`, `icon_class`, `direct_access`, `offline`, `state`, `page_name`, `page_id`, `addl_params`) VALUES
(NULL, 'Page/LoansCollectionsDashboard', 'COLLECTIONS_DASHBOARD', 'COLLECTIONS', 'fa fa-reply', '1', '0', 'Page.LoansCollectionsDashboard', '', '', '');



##################################################################################
Complated migration for SIT and  UAT on 29-09-2016 (POST MIGRATION)

ALTER TABLE `customer_bank_accounts` 
ADD COLUMN `customer_name_as_in_bank` VARCHAR(100) NULL AFTER `is_disbersement_account`;

ALTER TABLE `customer_bank_accounts_snapshot` 
ADD COLUMN `customer_name_as_in_bank` VARCHAR(100) NULL AFTER `is_disbersement_account`;


ENCORE (included in migration)
ALTER TABLE `loan_od_working_registers`
   CHANGE COLUMN `booked_not_due_normal_interest_magnitude`
`booked_not_due_normal_interest_magnitude` DECIMAL(18,6) NULL DEFAULT NULL ,
   CHANGE COLUMN `booked_not_due_penal_interest_magnitude`
`booked_not_due_penal_interest_magnitude` DECIMAL(18,6) NULL DEFAULT NULL ,
   CHANGE COLUMN `booked_normal_interest_magnitude`
`booked_normal_interest_magnitude` DECIMAL(18,6) NULL DEFAULT NULL ,
   CHANGE COLUMN `booked_penal_interest_magnitude` `booked_penal_interest_magnitude` DECIMAL(18,6) NULL DEFAULT NULL ;

ALTER TABLE `interest_computations`
   CHANGE COLUMN `interest_magnitude` `interest_magnitude` DECIMAL(18,6) NOT NULL ;

ALTER TABLE `npa_transactions`
   CHANGE COLUMN `booked_not_due_normal_interest_magnitude`
`booked_not_due_normal_interest_magnitude` DECIMAL(16,8) NULL DEFAULT NULL ,
   CHANGE COLUMN `booked_not_due_penal_interest_magnitude`
`booked_not_due_penal_interest_magnitude` DECIMAL(16,8) NULL ;

ALTER TABLE `casa_working_registers`
   CHANGE COLUMN `booked_interest_magnitude` `booked_interest_magnitude`
DECIMAL(16,8) NULL DEFAULT NULL ,
   CHANGE COLUMN `booked_not_paid_interest_magnitude`
`booked_not_paid_interest_magnitude` DECIMAL(16,8) NULL ;




########################################################################################################################
COMPLETED for Kinara UAT release on 28-09-2016 (PRE-MIGRATION)

perdix-server-0.0.2-SNAPSHOT_27092016.war


#####Perdix Migration (for migration) - 27-09-2016

ALTER TABLE `loan_accounts` 
  ADD COLUMN `first_repayment_date` DATE NULL DEFAULT NULL AFTER `fee5`;

ALTER TABLE `loan_account_disbursement_schedule` 
CHANGE COLUMN `mode_of_disbursement` `mode_of_disbursement` ENUM('CASH','CHEQUE','NEFT','RTGS') NULL DEFAULT NULL ;

ALTER TABLE `loan_account_disbursement_schedule_snapshot` 
CHANGE COLUMN `mode_of_disbursement` `mode_of_disbursement` ENUM('CASH','CHEQUE','NEFT','RTGS') NULL DEFAULT NULL ;


ALTER TABLE `bank_account_master` 
ADD COLUMN `generic_bank_account_flag` TINYINT NULL DEFAULT 0 AFTER `account_code`;

ALTER TABLE `loan_account_disbursement_schedule` 
ADD COLUMN `customer_bank_name` VARCHAR(100) NULL DEFAULT NULL AFTER `tranch_condition`,
ADD COLUMN `customer_bank_branch_name` VARCHAR(100) NULL DEFAULT NULL AFTER `customer_bank_name`,
ADD COLUMN `party` VARCHAR(20) NULL DEFAULT NULL AFTER `customer_bank_branch_name`,
ADD COLUMN `customer_name_in_bank` VARCHAR(100) NULL DEFAULT NULL AFTER `party`;


ALTER TABLE `loan_account_disbursement_schedule_snapshot` 
ADD COLUMN `customer_bank_name` VARCHAR(100) NULL DEFAULT NULL AFTER `tranch_condition`,
ADD COLUMN `customer_bank_branch_name` VARCHAR(100) NULL DEFAULT NULL AFTER `customer_bank_name`,
ADD COLUMN `party` VARCHAR(20) NULL DEFAULT NULL AFTER `customer_bank_branch_name`,
ADD COLUMN `customer_name_in_bank` VARCHAR(100) NULL DEFAULT NULL AFTER `party`;

INSERT INTO `translations` (`id`, `label_code`, `category`, `sub_category`, `type`, `en`, `hi`, `ta`) VALUES
(NULL, 'COLLECT_ADHOC_CHARGES', 'LOAN', 'CHARGE', '', 'Collect AdHoc Charges', '', ''),
(NULL, 'ADHOC_CHARGES', 'LOAN', 'CHARGE', '', 'AdHoc Charges', '', ''),
(NULL, 'CHARGE_FEE', 'LOAN', 'CHARGE', '', 'Charge Fee', '', ''),
(NULL, 'FEE_DETAILS', 'LOAN', 'CHARGE', '', 'Fee Details', '', ''),
(NULL, 'FEE_DATE', 'LOAN', 'CHARGE', '', 'Fee Date', '', ''),
(NULL, 'FEE_TYPE', 'LOAN', 'CHARGE', '', 'Fee Type', '', '');

UPDATE `bank_account_master` SET `generic_bank_account_flag` = '1' WHERE `bank_account_master`.`id` = 1;

ALTER TABLE `loan_account_documents` ADD UNIQUE( `document_code`, `product_code`);



ALTER TABLE `pdc_summary` 
ADD COLUMN `status` VARCHAR(45) NULL AFTER `branch_name`,
ADD COLUMN `status_date` DATETIME NULL AFTER `status`;

#####Stalin##
CREATE TABLE `loan_doc_reject_reasons` (
  `id` int(11) NOT NULL,
  `document_code` varchar(45) NOT NULL,
  `reject_reason` varchar(200) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

ALTER TABLE `loan_doc_reject_reasons`  ADD PRIMARY KEY (`id`);

ALTER TABLE `loan_account_documents` ADD UNIQUE( `document_code`, `product_code`);

ALTER TABLE `loan_doc_reject_reasons` MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=9;


#####Shahal##
  CREATE TABLE `ipmtb_repayment_details` (
    `id` bigint(20) UNSIGNED NOT NULL,
    `batchId` bigint(20) UNSIGNED DEFAULT NULL,
    `batchStatus` tinyint(3) UNSIGNED DEFAULT NULL,
    `demandDate` date NOT NULL,
    `branchId` int(10) UNSIGNED NOT NULL,
    `transactionId` varchar(100) DEFAULT NULL,
    `valueDate` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    `transactionDate` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00',
    `systemDateAndTime` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00',
    `accountId` varchar(100) DEFAULT NULL,
    `entityId` varchar(100) DEFAULT NULL,
    `sequenceNum` smallint(6) DEFAULT NULL,
    `transactionName` varchar(100) DEFAULT NULL,
    `part1` varchar(100) DEFAULT NULL,
    `part2` varchar(100) DEFAULT NULL,
    `part3` varchar(100) DEFAULT NULL,
    `part4` varchar(100) DEFAULT NULL,
    `part5` varchar(100) DEFAULT NULL,
    `part6` varchar(100) DEFAULT NULL,
    `amount1` varchar(100) DEFAULT NULL,
    `amount2` varchar(100) DEFAULT NULL,
    `amount3` varchar(100) DEFAULT NULL,
    `description` varchar(100) DEFAULT NULL,
    `userId` varchar(100) DEFAULT NULL,
    `customerName` varchar(100) DEFAULT NULL,
    `status` varchar(100) DEFAULT NULL,
    `responseCode` varchar(100) DEFAULT NULL,
    `payeeAccountId` varchar(100) DEFAULT NULL,
    `param1` varchar(100) DEFAULT NULL,
    `param2` varchar(100) DEFAULT NULL,
    `instrument` varchar(100) DEFAULT NULL,
    `reference` varchar(100) DEFAULT NULL
  ) ENGINE=InnoDB DEFAULT CHARSET=latin1;

  ALTER TABLE `ipmtb_repayment_details`
    ADD PRIMARY KEY (`id`),
    ADD KEY `idx_instrument_demanddate` (`instrument`,`demandDate`) USING BTREE;

  ALTER TABLE `ipmtb_repayment_details`
    MODIFY `id` bigint(20) UNSIGNED NOT NULL AUTO_INCREMENT;



####Encore Migration.
ALTER TABLE `encoredb`.`account_pdc` 
DROP INDEX `tenant_code` 
, ADD UNIQUE INDEX `tenant_code` (`tenant_code` ASC, `pdc_num` ASC, `account_id` ASC) 
, ADD UNIQUE INDEX `tenant_code1` (`tenant_code` ASC, `account_id` ASC, `ifsc_code` ASC, `bank_account_no` ASC, `cheque_no` ASC) ;

   
#########################################################################################################
COMPLETED for KINARA UAT release 23-09-2016

perdix-server-0.0.2-SNAPSHOT-23092016.war

encoredb: 
    district_master 
    state_master

financialForms:
    reference_code
    pincode_master
    district_master
    state_master

ALTER TABLE `bank_account_master`
add COLUMN `default_collection_account` TINYINT(1) NOT NULL DEFAULT 0 AFTER `branch_address` ;

ALTER TABLE `bank_account_master`
ADD COLUMN `account_code` VARCHAR(45) DEFAULT NULL AFTER `default_collection_account`;

ALTER TABLE `ach_registration`
ADD COLUMN `sponsor_account_code` VARCHAR(45) DEFAULT NULL AFTER `processed_on_with_umrn`;

CREATE TABLE `temp_schedule_demands` (
  `id` INT(4) UNSIGNED NOT NULL AUTO_INCREMENT,
  `version` INT(4) NULL DEFAULT NULL,
  `account_number` VARCHAR(45) NOT NULL,
  `sequence_number` INT(4) NOT NULL,
  `transaction_name` VARCHAR(45) NULL DEFAULT NULL,
  `demand_date` date DEFAULT NULL,
  `transaction_date` date DEFAULT NULL,
  `installment_amount` DECIMAL(10,2) DEFAULT '0.0',
  `balance_amount` DECIMAL(10,2) DEFAULT '0.0',
  `interest_due` DECIMAL(10,2) DEFAULT '0.0',
  `principal_due` DECIMAL(10,2) DEFAULT '0.0',
  `status` VARCHAR(45) NULL DEFAULT NULL,
  `created_by` VARCHAR(100) NULL DEFAULT NULL,
  `created_at` DATETIME NULL DEFAULT NULL,
  `last_edited_by` VARCHAR(100) NULL DEFAULT NULL,
  `last_edited_at` DATETIME NULL DEFAULT NULL,
  PRIMARY KEY (`id`) );

  
INSERT INTO `reference_code` (`classifier`, `name`, `code`, `field1`, `field2`, `created_by`, `created_at`, `last_edited_by`, `last_edited_at`) VALUES ('bounce_master', 'Account Closed Or Transferred', '1', '100', 'CBC', 'SYSTEM', '2016-08-19', 'SYSTEM', '2016-08-19');
INSERT INTO `reference_code` (`classifier`, `name`, `code`, `field1`, `field2`, `created_by`, `created_at`, `last_edited_by`, `last_edited_at`) VALUES ('bounce_master', 'Balance Insufficient', '4', '100', 'CBC', 'SYSTEM', '2016-08-19', 'SYSTEM', '2016-08-19');
INSERT INTO `reference_code` (`classifier`, `name`, `code`, `field1`, `field2`, `created_by`, `created_at`, `last_edited_by`, `last_edited_at`) VALUES ('bounce_master', 'Not Arranged For/Amount Exceeding Limit set by A/c Holder', '5', '100', 'CBC', 'SYSTEM', '2016-08-19', 'SYSTEM', '2016-08-19');
INSERT INTO `reference_code` (`classifier`, `name`, `code`, `field1`, `field2`, `created_by`, `created_at`, `last_edited_by`, `last_edited_at`) VALUES ('bounce_master', 'Payment Stopped by Drawer', '6', '100', 'SYSTEM', '2016-08-19', 'CBC', 'SYSTEM', '2016-08-19');
INSERT INTO `reference_code` (`classifier`, `name`, `code`, `field1`, `field2`, `created_by`, `created_at`, `last_edited_by`, `last_edited_at`) VALUES ('bounce_master', 'Payment Stopped Under Court Order/Account Under Litigation', '7', '100', 'CBC', 'SYSTEM', '2016-08-19', 'SYSTEM', '2016-08-19');
INSERT INTO `reference_code` (`classifier`, `name`, `code`, `field1`, `field2`, `created_by`, `created_at`, `last_edited_by`, `last_edited_at`) VALUES ('bounce_master', 'Miscellaneous - KYC Documents Pending', '51', '100', 'CBC', 'SYSTEM', '2016-08-19', 'SYSTEM', '2016-08-19');
INSERT INTO `reference_code` (`classifier`, `name`, `code`, `field1`, `field2`, `created_by`, `created_at`, `last_edited_by`, `last_edited_at`) VALUES ('bounce_master', 'Miscellaneous - Documents Pending for Account Holder Turning Major', '52', '100', 'CBC', 'SYSTEM', '2016-08-19', 'SYSTEM', '2016-08-19');
INSERT INTO `reference_code` (`classifier`, `name`, `code`, `field1`, `field2`, `created_by`, `created_at`, `last_edited_by`, `last_edited_at`) VALUES ('bounce_master', 'Miscellaneous - A/c Inactive (No transactions for last three months)', '53', '100', 'CBC', 'SYSTEM', '2016-08-19', 'SYSTEM', '2016-08-19');
INSERT INTO `reference_code` (`classifier`, `name`, `code`, `field1`, `field2`, `created_by`, `created_at`, `last_edited_by`, `last_edited_at`) VALUES ('bounce_master', 'Miscellaneous - Dormant A/c (No transactions for last six months)', '54', '100', 'CBC', 'SYSTEM', '2016-08-19', 'SYSTEM', '2016-08-19');
INSERT INTO `reference_code` (`classifier`, `name`, `code`, `field1`, `field2`, `created_by`, `created_at`, `last_edited_by`, `last_edited_at`) VALUES ('bounce_master', 'Miscellaneous - Simple Account, first transaction should be credit initiated from base branch', '55', '100','CBC',  'SYSTEM', '2016-08-19', 'SYSTEM', '2016-08-19');
INSERT INTO `reference_code` (`classifier`, `name`, `code`, `field1`, `field2`, `created_by`, `created_at`, `last_edited_by`, `last_edited_at`) VALUES ('bounce_master', 'Miscellaneous - Amount exceeds limit set on account by bank for debit per transaction', '56', '100', 'CBC', 'SYSTEM', '2016-08-19', 'SYSTEM', '2016-08-19');
INSERT INTO `reference_code` (`classifier`, `name`, `code`, `field1`, `field2`, `created_by`, `created_at`, `last_edited_by`, `last_edited_at`) VALUES ('bounce_master', 'Miscellaneous - Amount exceeds limit set on account by bank for debit per transaction', '57', '100', 'CBC', 'SYSTEM', '2016-08-19', 'SYSTEM', '2016-08-19');
INSERT INTO `reference_code` (`classifier`, `name`, `code`, `field1`, `field2`, `created_by`, `created_at`, `last_edited_by`, `last_edited_at`) VALUES ('bounce_master', 'Miscellaneous - Account reached maximum debit limit set on account by bank', '58', '100', 'CBC', 'SYSTEM', '2016-08-19', 'SYSTEM', '2016-08-19');
INSERT INTO `reference_code` (`classifier`, `name`, `code`, `field1`, `field2`, `created_by`, `created_at`, `last_edited_by`, `last_edited_at`) VALUES ('bounce_master', 'Miscellaneous - Network Failure (CBS)', '59', '100', 'CBC', 'SYSTEM', '2016-08-19', 'SYSTEM', '2016-08-19');
INSERT INTO `reference_code` (`classifier`, `name`, `code`, `field1`, `field2`, `created_by`, `created_at`, `last_edited_by`, `last_edited_at`) VALUES ('bounce_master', 'Account Holder Expired', '60', '100', 'CBC', 'SYSTEM', '2016-08-19', 'SYSTEM', '2016-08-19');
INSERT INTO `reference_code` (`classifier`, `name`, `code`, `field1`, `field2`, `created_by`, `created_at`, `last_edited_by`, `last_edited_at`) VALUES ('bounce_master', 'Mandate Cancelled', '61', '100', 'CBC', 'SYSTEM', '2016-08-19', 'SYSTEM', '2016-08-19');
INSERT INTO `reference_code` (`classifier`, `name`, `code`, `field1`, `field2`, `created_by`, `created_at`, `last_edited_by`, `last_edited_at`) VALUES ('bounce_master', 'Account Blocked / Frozen', '68', '100', 'CBC', 'SYSTEM', '2016-08-19', 'SYSTEM', '2016-08-19');
INSERT INTO `reference_code` (`classifier`, `name`, `code`, `field1`, `field2`, `created_by`, `created_at`, `last_edited_by`, `last_edited_at`) VALUES ('bounce_master', 'Customer Insolvent / Insane', '69', '100', 'CBC', 'SYSTEM', '2016-08-19', 'SYSTEM', '2016-08-19');
INSERT INTO `reference_code` (`classifier`, `name`, `code`, `field1`, `field2`, `created_by`, `created_at`, `last_edited_by`, `last_edited_at`) VALUES ('bounce_master', 'Customer to refer to the Branch', '70', '100', 'CBC', 'SYSTEM', '2016-08-19', 'SYSTEM', '2016-08-19');

CREATE TABLE `enterprise_registrations` (
  `id` int(4) unsigned NOT NULL AUTO_INCREMENT,
  `version` int(4) NOT NULL,
  `customer_id` int(4) unsigned NOT NULL,
  `registration_type` varchar(45) DEFAULT NULL,
  `registration_number` varchar(45) DEFAULT NULL,
  `registered_date` date DEFAULT NULL,
  `expiry_date` date DEFAULT NULL,
  `created_by` varchar(45) NOT NULL,
  `created_at` datetime NOT NULL,
  `last_edited_by` varchar(45) DEFAULT NULL,
  `last_edited_at` datetime DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `customer_id_fk_idx` (`customer_id`),
  CONSTRAINT `customer_id_fk` FOREIGN KEY (`customer_id`) REFERENCES `customer` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=latin1;


CREATE TABLE `enterprise_registrations_snapshot` (
  `id` int(4) NOT NULL AUTO_INCREMENT,
  `version` int(4) NOT NULL,
  `customer_id` int(4) NOT NULL,
  `registration_type` varchar(45) DEFAULT NULL,
  `registration_number` varchar(45) DEFAULT NULL,
  `registered_date` datetime DEFAULT NULL,
  `expiry_date` datetime DEFAULT NULL,
  `customer_snapshot_id` int(4) NOT NULL,
  `created_by` varchar(45) NOT NULL,
  `created_at` datetime NOT NULL,
  `last_edited_by` varchar(45) DEFAULT NULL,
  `last_edited_at` datetime DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=latin1;

ALTER TABLE `customer_bank_accounts_snapshot`
ADD COLUMN `customer_snapshot_id` INT(4) NOT NULL AFTER `is_disbersement_account`;


##########################################################################################################################

# DEPLOYMENT COMPLETED in KINARA UAT  21-09-2016 


********WAR to be released**************

perdix-server-0.0.2-SNAPSHOT-21092016.war
 
*********Migration to Run*************** 


ALTER TABLE `loan_products`
ADD COLUMN `min_interest_rate` DECIMAL(10,2) NOT NULL DEFAULT '0.00' AFTER `insurance_type`,
ADD COLUMN `max_interest_rate` DECIMAL(10,2) NOT NULL DEFAULT '0.00' AFTER `min_interest_rate`;

ALTER TABLE `customer` 
CHANGE COLUMN `marital_status` `marital_status` ENUM('SINGLE', 'MARRIED', 'DIVORCE', 'WIDOW', 'UNSPECIFIED') NULL DEFAULT NULL ;

ALTER TABLE `customer_snapshot` 
CHANGE COLUMN `marital_status` `marital_status` ENUM('SINGLE', 'MARRIED', 'DIVORCE', 'WIDOW', 'UNSPECIFIED') NULL DEFAULT NULL ;

ALTER TABLE `loan_account_disbursement_schedule` 
ADD COLUMN `response_code` VARCHAR(100) NULL DEFAULT NULL AFTER `mode_of_disbursement`;

ALTER TABLE `loan_account_disbursement_schedule_snapshot` 
ADD COLUMN `response_code` VARCHAR(100) NULL DEFAULT NULL AFTER `mode_of_disbursement`;


ALTER TABLE `individual_loan_documents` 
ADD COLUMN `reject_reason` VARCHAR(500) NULL AFTER `account_number`;

ALTER TABLE `individual_loan_documents_snapshot` 
ADD COLUMN `reject_reason` VARCHAR(500) NULL AFTER `account_number`;


ALTER TABLE `loan_account_disbursement_schedule` 
ADD COLUMN `tranch_condition` VARCHAR(300) NULL AFTER `response_code`;

ALTER TABLE `loan_account_disbursement_schedule_snapshot` 
ADD COLUMN `tranch_condition` VARCHAR(300) NULL AFTER `response_code`;


ALTER TABLE `loan_repayment_details` 
CHANGE COLUMN `payment_type` `payment_type` ENUM('LOAN_CASHIN','LOAN_CASHOUT','CHQ_OUT','NEFT_OUT','RTGS_OUT','CHQ_IN','NEFT_IN','RTGS_IN','ACH_IN','PDC_IN') NULL DEFAULT 'LOAN_CASHIN' ;



####################################################################################################################

# DEPLOYMENT COMPLATED in KINARA UAT from 19-09-2016 

********WAR to be released**************

perdix-server-0.0.2-SNAPSHOT-19092016-3.war
 
*********Migration to Run*************** 


ALTER TABLE `ach_registration` 
CHANGE COLUMN `mandate_status` `mandate_status` ENUM('PENDING', 'SUBMITTED', 'RE-SUBMITTED', 'REJECTED', 'ACCEPTED') NULL DEFAULT NULL ;

ALTER TABLE `portfolio_insurance_master` 
ADD UNIQUE INDEX `age_gender_sum_tenure` (`age` ASC, `gender` ASC, `tenure_in_year` ASC, `sum_assured` ASC)  COMMENT '';


ALTER TABLE `enterprise` 
ADD COLUMN `business_sub_type` VARCHAR(100) NULL AFTER `business_sector`,
ADD COLUMN `is_company_registered` DATE NULL AFTER `company_operating_since`;

ALTER TABLE `enterprise` 
	ADD COLUMN `tin` VARCHAR(45) NULL DEFAULT NULL AFTER `referred_name`,
	ADD COLUMN `ssi_number` VARCHAR(100) NULL DEFAULT NULL AFTER `tin`,
	ADD COLUMN `vat_number` VARCHAR(100) NULL DEFAULT NULL AFTER `ssi_number`,
	ADD COLUMN `business_pan_card` VARCHAR(100) NULL DEFAULT NULL AFTER `vat_number`,
	ADD COLUMN `service_tax_number` VARCHAR(100) NULL DEFAULT NULL AFTER `business_pan_card`,
	ADD COLUMN `dic` VARCHAR(100) NULL DEFAULT NULL AFTER `service_tax_number`;


ALTER TABLE `enterprise_snapshot` 
	ADD COLUMN `tin` VARCHAR(45) NULL DEFAULT NULL AFTER `referred_name`,
	ADD COLUMN `ssi_number` VARCHAR(100) NULL DEFAULT NULL AFTER `tin`,
	ADD COLUMN `vat_number` VARCHAR(100) NULL DEFAULT NULL AFTER `ssi_number`,
	ADD COLUMN `business_pan_card` VARCHAR(100) NULL DEFAULT NULL AFTER `vat_number`,
	ADD COLUMN `service_tax_number` VARCHAR(100) NULL DEFAULT NULL AFTER `business_pan_card`,
	ADD COLUMN `dic` VARCHAR(100) NULL DEFAULT NULL AFTER `service_tax_number`;



ALTER TABLE `loan_accounts` 
ADD COLUMN `processing_fee_percentage` DECIMAL(10,2) NULL DEFAULT NULL AFTER `portfolio_insurance_premium`,
ADD COLUMN `security_emi_required` ENUM('Yes', 'No') NULL DEFAULT NULL AFTER `processing_fee_percentage`;

ALTER TABLE `loan_accounts_snapshot` 
ADD COLUMN `processing_fee_percentage` DECIMAL(10,2) NULL DEFAULT NULL AFTER `portfolio_insurance_premium`,
ADD COLUMN `security_emi_required` ENUM('Yes', 'No') NULL DEFAULT NULL AFTER `processing_fee_percentage`;

ALTER TABLE `individual_loan_documents` 
ADD COLUMN `account_number` VARCHAR(100) NULL DEFAULT NULL AFTER `disbursement_id`;

ALTER TABLE `individual_loan_documents_snapshot` 
ADD COLUMN `account_number` VARCHAR(100) NULL DEFAULT NULL AFTER `disbursement_id`;

ALTER TABLE `loan_accounts`
ADD COLUMN `fee3` decimal(10,2) NULL DEFAULT NULL AFTER `security_emi_required`,
ADD COLUMN `fee4` decimal(10,2) NULL DEFAULT NULL AFTER `fee3`,
ADD COLUMN `fee5` decimal(10,2) NULL DEFAULT NULL AFTER `fee4`;

ALTER TABLE `loan_accounts_snapshot`
ADD COLUMN `fee3` decimal(10,2) NULL DEFAULT NULL AFTER `security_emi_required`,
ADD COLUMN `fee4` decimal(10,2) NULL DEFAULT NULL AFTER `fee3`,
ADD COLUMN `fee5` decimal(10,2) NULL DEFAULT NULL AFTER `fee4`;

CREATE TABLE `loan_customer_relation` (
  `id` int(4) unsigned NOT NULL AUTO_INCREMENT,
  `version` int(4) NOT NULL,
  `loan_id` int(4) unsigned NOT NULL,
  `urn` varchar(45) DEFAULT NULL,
  `relation` varchar(45) DEFAULT NULL,
  `created_by` varchar(45) NOT NULL,
  `created_at` datetime NOT NULL,
  `last_edited_by` varchar(45) DEFAULT NULL,
  `last_edited_at` datetime DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `loan_account_id_fk_idx` (`loan_id`),
  CONSTRAINT `loan_account_id_fk` FOREIGN KEY (`loan_id`) REFERENCES `loan_accounts` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

  
CREATE TABLE `loan_customer_relation_snapshot` (
  `id` int(4) NOT NULL AUTO_INCREMENT,
  `version` int(4) NOT NULL,
  `loan_id` int(4) DEFAULT NULL,
  `loan_snapshot_id` int(4) DEFAULT NULL,
  `urn` varchar(45) DEFAULT NULL,
  `relation` varchar(45) DEFAULT NULL,
  `created_by` VARCHAR(45) NOT NULL,
  `created_at` DATETIME NOT NULL,
  `last_edited_by` VARCHAR(45) NULL,
  `last_edited_at` DATETIME NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

ALTER TABLE `loan_products`
ADD COLUMN `min_interest_rate` DECIMAL(10,2) NOT NULL DEFAULT '0.00' AFTER `insurance_type`,
ADD COLUMN `max_interest_rate` DECIMAL(10,2) NOT NULL DEFAULT '0.00' AFTER `min_interest_rate`;

